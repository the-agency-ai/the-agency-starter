#!/bin/bash
# Output the commit message prefix: {workstream}/{agentname}:
#
# Usage: ./tools/commit-prefix
#        MSG="$(./tools/commit-prefix) your message here"
#
# Returns: {workstream}/{agentname}:
# Example: housekeeping/housekeeping:
#          agents/agent-manager:
#

# Source log helper for telemetry
SCRIPT_DIR="${SCRIPT_DIR:-$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)}"
if [[ -f "$SCRIPT_DIR/_log-helper" ]]; then
    source "$SCRIPT_DIR/_log-helper"
fi
RUN_ID=$(log_start "commit-prefix" "agency-tool" "$@" 2>/dev/null) || true
# If workstream or agent unknown, uses "unknown" as fallback.


# Tool version
TOOL_VERSION="1.0.0-20260109-000001"

# Version check
if [[ "${1:-}" == "--version" || "${1:-}" == "-v" ]]; then
    echo "commit-prefix $TOOL_VERSION"
    exit 0
fi

WORKSTREAM=$(./tools/workstream 2>/dev/null || echo "unknown")
AGENTNAME=$(./tools/agentname 2>/dev/null || echo "unknown")

echo "${WORKSTREAM}/${AGENTNAME}:"
